# NBI-2001-Ecuador
#El script permite el cálculo del índice de necesidades básicas insatisfechas en Ecuador. El script fue adaptado del provisto por el INEC para el año 2010, ya que algunas variables cambiaron su clave de identificación respecto al censo 2001.
# Anexo 4 Sintaxis para el cálculo del índice NBI desarrollado por INEC y adaptado en esta tesis para las variables del censo 2001
# Adaptado por: Victor Torres Lopez
# Manual para adquisición de datos disponible en:
## https://victorhugotorreslopez.wordpress.com/2016/01/20/calculo-del-indice-de-necesidades-basicas-insatisfechas-en-ecuador-nbi/ 
## Publicado en Septiembre 2015 Actualizado: Enero 21.01.2016

RUNDEF programa  NBI SD 2001
   SELECTION "Z:\01_gis_trabajo\INEC2001\PROCE_REDAT_2001\1706SD2001.sel"
   COMPLETENAME 
    UNIVERSE VIVIENDA.TIPVIV <= 8 AND VIVIENDA.CONOCU = 1 


*/ INDICADOR DE NECESIDADES BÁSICAS INSATISFECHAS */    

/*  COMPONENTES: MATERIALES DE LA VIVIENDA DEFICITARIOS*/ 
   
DEFINE HOGAR.MATERIAL
    AS 1
    FOR ( VIVIENDA.PARED >4 AND VIVIENDA.PARED <= 6 ) OR ( VIVIENDA.PISO > 4 AND VIVIENDA.PISO <= 6 )
    TYPE INTEGER
    RANGE 0-1
    VARLABEL "MATERIALES DE LA VIVIENDA DEFICITARIOS"
    VALUELABELS
    1 " Hogares con materiales de vivienda deficitarios"
    0 " Hogares con materiales de vivienda no deficitarios"
    DEFAULT 0
   /* 
       
    TABLE MATERIAL
    TITLE "MATERIAL DE LA VIVIENDA DEFICITARIOS"
    AS FREQUENCY 
    OF HOGAR.MATERIAL
    COMPLETENAME 
 */       
     
/* COMPONENTE: SERVICIOS DE LA VIVIENDA INADECUADOS*/ 
            
 DEFINE HOGAR.SERVICIO
    AS 1
    FOR ( VIVIENDA.MEDABA > 1 AND VIVIENDA.MEDABA <= 5 ) OR ( VIVIENDA.SISABA > 1 AND VIVIENDA.SISABA <= 4 ) OR ( VIVIENDA.ELIAGU > 2 AND VIVIENDA.ELIAGUA <= 4 )
    TYPE INTEGER
    RANGE 0-1
    VARLABEL "SERVICIOS DE LA VIVIENDA INADECUADOS"
    VALUELABELS
    1 " Hogares con servicios de las viviendas inadecuados"
    0 " Hogares con servicios adecuados"
    DEFAULT 0
  /*  
        
    TABLE SERVICIOS
    TITLE " SERVICIOS DE LA VIVIENDA INADECUADOS"
    AS FREQUENCY 
    OF HOGAR.SERVICIO   
    COMPLETENAME 
    
 */
    
/* COMPONENTE HACINAMIENTO  */ 
 
       
    DEFINE HOGAR.perxdor
    AS SWITCH
    INCASE HOGAR.SUMDOR >  0
    ASSIGN HOGAR.TOTPER / HOGAR.SUMDOR
    INCASE HOGAR.SUMDOR = 0
    ASSIGN HOGAR.TOTPER
    TYPE REAL

    DEFINE HOGAR.defhacin
    AS SWITCH
    INCASE HOGAR.SUMDOR > 0  AND HOGAR.perxdor <= 3
    ASSIGN 0
    INCASE HOGAR.SUMDOR > 0  AND HOGAR.perxdor > 3
    ASSIGN 1
    INCASE HOGAR.SUMDOR =0 AND HOGAR.TOTPER <=3
    ASSIGN 0
    INCASE HOGAR.SUMDOR =0 AND HOGAR.TOTPER >3
    ASSIGN 1
    TYPE INTEGER 
    RANGE 0-1
    VALUELABELS
    1 "HOGARES CON HACINAMIENTO"
    0 "HOGARES SIN HACINAMIENTO"
    


/*
TABLE HACINAMIENTO
AS FREQUENCY 
OF HOGAR.defhacin
    
*/    
    
*/ COMP0NENTE : NIÑOS DE 6 A 12 AÑOS QUE NO ASISTEN A CLASES */ 
            
DEFINE HOGAR.NINNOASIS
    AS 1
    FOR ( PERSONA.EDAD > 5 AND PERSONA.EDAD <= 12 ) AND PERSONA.ASISTE = 2 
    TYPE INTEGER
    RANGE 0-1
    VARLABEL "NIÑOS NO ASISTEN"
    VALUELABELS
    1 " Hogares con niños que no asisten a la escuela"
    0 " Hogares  sin niños que no asistan a la escuela"
    DEFAULT 0
    
 /*
    TABLE NINOASIS
    TITLE " NIÑOS ENTRE 6 Y 12 AÑOS QUE NO ASISTEN A ESCUELA"
    AS FREQUENCY 
    OF HOGAR.NINNOASIS
    COMPLETENAME    
*/    
                              
    
/* COMPONENTE: DEPENDENCIA ECONOMICA */ 
                   
/* CONTANDO OCUPADOS DE 10 AÑOS Y MÁS*/

DEFINE HOGAR.OCU
    AS COUNT PERSONA
    TYPE INTEGER
    FOR  PERSONA.EDAD >= 10 AND PERSONA.HISEMP < 3  

   
    
/* CALCULADO COCIENTE  TOTAL MIEMBROS DE HOGAR PARA OCUPADOS EN EL HOGAR*/ 
          
DEFINE HOGAR.PEROCU
    AS HOGAR.TOTPER / HOGAR.OCU 
    TYPE REAL
    FOR HOGAR.OCU >0 
         
                     
/* CALCULANDO  HOGARES PROMEDIO DE 3 O MAS MIEMBROS DEL HOGAR POR CADA OCUPADO */ 

DEFINE HOGAR.MIXOCU1
    AS SWITCH
    INCASE HOGAR.PEROCU > 3
    ASSIGN 1
    INCASE HOGAR.OCU = 0
    ASSIGN 1
    RANGE 0-1
    TYPE INTEGER
    DEFAULT 0 
    
    **** Años de Escolaridad**


DEFINE PERSONA.DIST
    AS PERSONA.NIVINS * 100 + PERSONA.GRADO    
    TYPE INTEGER
    FOR PERSONA.NIVINS < 99 
    
DEFINE PERSONA.ESCONBI
    AS SWITCH
    INCASE PERSONA.NIVINS = 0
    ASSIGN 0
   INCASE PERSONA.DIST = 101 AND PERSONA.ASISTE = 1
    ASSIGN 0
    INCASE PERSONA.DIST = 101 AND PERSONA.ASISTE = 2
    ASSIGN 3
    INCASE PERSONA.DIST = 102 AND PERSONA.ASISTE = 1
    ASSIGN 3
    INCASE PERSONA.DIST = 102 AND PERSONA.ASISTE = 2
    ASSIGN 5
    INCASE PERSONA.DIST = 103 AND PERSONA.ASISTE = 1
    ASSIGN 5
    INCASE PERSONA.DIST = 103 AND PERSONA.ASISTE = 2
    ASSIGN 7
    INCASE PERSONA.DIST = 201 AND PERSONA.ASISTE = 1
    ASSIGN 1
    INCASE PERSONA.DIST = 201 AND PERSONA.ASISTE = 2
    ASSIGN 2
    INCASE PERSONA.DIST = 202 AND PERSONA.ASISTE = 1
    ASSIGN 2
    INCASE PERSONA.DIST = 202 AND PERSONA.ASISTE = 2
    ASSIGN 3
    INCASE PERSONA.DIST = 203 AND PERSONA.ASISTE = 1
    ASSIGN 3
    INCASE PERSONA.DIST = 203 AND PERSONA.ASISTE = 2
    ASSIGN 4
    INCASE PERSONA.DIST = 204 AND PERSONA.ASISTE = 1
    ASSIGN 4
    INCASE PERSONA.DIST = 204 AND PERSONA.ASISTE = 2
    ASSIGN 5
    INCASE PERSONA.DIST = 205 AND PERSONA.ASISTE = 1
    ASSIGN 5
    INCASE PERSONA.DIST = 205 AND PERSONA.ASISTE = 2
    ASSIGN 6
    INCASE PERSONA.DIST = 206 AND PERSONA.ASISTE = 1
    ASSIGN 6
    INCASE PERSONA.DIST = 206 AND PERSONA.ASISTE = 2
    ASSIGN 7
    INCASE PERSONA.DIST = 301 AND PERSONA.ASISTE = 1
    ASSIGN 7
    INCASE PERSONA.DIST = 301 AND PERSONA.ASISTE = 2
    ASSIGN 8
    INCASE PERSONA.DIST = 302 AND PERSONA.ASISTE = 1
    ASSIGN 8
    INCASE PERSONA.DIST = 302 AND PERSONA.ASISTE = 2
    ASSIGN 9
    INCASE PERSONA.DIST = 303 AND PERSONA.ASISTE = 1
    ASSIGN 9
    INCASE PERSONA.DIST = 303 AND PERSONA.ASISTE = 2
    ASSIGN 10
    INCASE PERSONA.DIST = 304 AND PERSONA.ASISTE = 1
    ASSIGN 10
    INCASE PERSONA.DIST = 304 AND PERSONA.ASISTE = 2
    ASSIGN 11
    INCASE PERSONA.DIST = 305 AND PERSONA.ASISTE = 1
    ASSIGN 11
    INCASE PERSONA.DIST = 305 AND PERSONA.ASISTE = 2
    ASSIGN 12
    INCASE PERSONA.DIST = 306 AND PERSONA.ASISTE = 1
    ASSIGN 12
    INCASE PERSONA.DIST = 306 AND PERSONA.ASISTE = 2
    ASSIGN 13
    INCASE PERSONA.DIST = 401 AND PERSONA.ASISTE = 1
    ASSIGN 0
    INCASE PERSONA.DIST = 401 AND PERSONA.ASISTE = 2
    ASSIGN 1
    INCASE PERSONA.DIST = 402 AND PERSONA.ASISTE = 1
    ASSIGN 1
    INCASE PERSONA.DIST = 402 AND PERSONA.ASISTE = 2
    ASSIGN 2
    INCASE PERSONA.DIST = 403 AND PERSONA.ASISTE = 1
    ASSIGN 2
    INCASE PERSONA.DIST = 403 AND PERSONA.ASISTE = 2
    ASSIGN 3
    INCASE PERSONA.DIST = 404 AND PERSONA.ASISTE = 1
    ASSIGN 3
    INCASE PERSONA.DIST = 404 AND PERSONA.ASISTE = 2
    ASSIGN 4
    INCASE PERSONA.DIST = 405 AND PERSONA.ASISTE = 1
    ASSIGN 4
    INCASE PERSONA.DIST = 405 AND PERSONA.ASISTE = 2
    ASSIGN 5
    INCASE PERSONA.DIST = 406 AND PERSONA.ASISTE = 1
    ASSIGN 5
    INCASE PERSONA.DIST = 406 AND PERSONA.ASISTE = 2
    ASSIGN 6
    INCASE PERSONA.DIST = 407 AND PERSONA.ASISTE = 1
    ASSIGN 6
    INCASE PERSONA.DIST = 407 AND PERSONA.ASISTE = 2
    ASSIGN 7
    INCASE PERSONA.DIST = 408 AND PERSONA.ASISTE = 1
    ASSIGN 7
    INCASE PERSONA.DIST = 408 AND PERSONA.ASISTE = 2
    ASSIGN 8
    INCASE PERSONA.DIST = 409 AND PERSONA.ASISTE = 1
    ASSIGN 8
    INCASE PERSONA.DIST = 409 AND PERSONA.ASISTE = 2
    ASSIGN 9
    INCASE PERSONA.DIST = 410 AND PERSONA.ASISTE = 1
    ASSIGN 9
    INCASE PERSONA.DIST = 410 AND PERSONA.ASISTE = 2
    ASSIGN 10
    INCASE PERSONA.DIST = 501 AND PERSONA.ASISTE = 1
    ASSIGN 10
    INCASE PERSONA.DIST = 501 AND PERSONA.ASISTE = 2
    ASSIGN 11
    INCASE PERSONA.DIST = 502 AND PERSONA.ASISTE = 1
    ASSIGN 11
    INCASE PERSONA.DIST = 502 AND PERSONA.ASISTE = 2
    ASSIGN 12
    INCASE PERSONA.DIST = 503 AND PERSONA.ASISTE = 1
    ASSIGN 12
    INCASE PERSONA.DIST = 503 AND PERSONA.ASISTE = 2
    ASSIGN 13
    INCASE PERSONA.DIST = 601 AND PERSONA.ASISTE = 1
    ASSIGN 13
    INCASE PERSONA.DIST = 601 AND PERSONA.ASISTE = 2
    ASSIGN 14
    INCASE PERSONA.DIST = 602 AND PERSONA.ASISTE = 1
    ASSIGN 14
    INCASE PERSONA.DIST = 602 AND PERSONA.ASISTE = 2
    ASSIGN 15
    INCASE PERSONA.DIST = 603 AND PERSONA.ASISTE = 1
    ASSIGN 15
    INCASE PERSONA.DIST = 603 AND PERSONA.ASISTE = 2
    ASSIGN 16
    INCASE PERSONA.DIST = 701 AND PERSONA.ASISTE = 1
    ASSIGN 13
    INCASE PERSONA.DIST = 701 AND PERSONA.ASISTE = 2
    ASSIGN 14
    INCASE PERSONA.DIST = 702 AND PERSONA.ASISTE = 1
    ASSIGN 14
    INCASE PERSONA.DIST = 702 AND PERSONA.ASISTE = 2
    ASSIGN 15
    INCASE PERSONA.DIST = 703 AND PERSONA.ASISTE = 1
    ASSIGN 15
    INCASE PERSONA.DIST = 703 AND PERSONA.ASISTE = 2
    ASSIGN 16
    INCASE PERSONA.DIST = 704 AND PERSONA.ASISTE = 1
    ASSIGN 16
    INCASE PERSONA.DIST = 704 AND PERSONA.ASISTE = 2
    ASSIGN 17
    INCASE PERSONA.DIST = 705 AND PERSONA.ASISTE = 1
    ASSIGN 17
    INCASE PERSONA.DIST = 705 AND PERSONA.ASISTE = 2
    ASSIGN 18
    INCASE PERSONA.DIST = 706 AND PERSONA.ASISTE = 1
    ASSIGN 18
    INCASE PERSONA.DIST = 706 AND PERSONA.ASISTE = 2
    ASSIGN 19
    INCASE PERSONA.DIST = 707 AND PERSONA.ASISTE = 1
    ASSIGN 19
    INCASE PERSONA.DIST = 707 AND PERSONA.ASISTE = 2
    ASSIGN 20
    INCASE PERSONA.DIST = 708 AND PERSONA.ASISTE = 1
    ASSIGN 20
    INCASE PERSONA.DIST = 708 AND PERSONA.ASISTE = 2
    ASSIGN 21
    INCASE PERSONA.DIST = 801 AND PERSONA.ASISTE = 1
    ASSIGN 18
    INCASE PERSONA.DIST = 801 AND PERSONA.ASISTE = 2
    ASSIGN 19
    INCASE PERSONA.DIST = 802 AND PERSONA.ASISTE = 1
    ASSIGN 19
    INCASE PERSONA.DIST = 802 AND PERSONA.ASISTE = 2
    ASSIGN 20
    INCASE PERSONA.DIST = 803 AND PERSONA.ASISTE = 1
    ASSIGN 20
    INCASE PERSONA.DIST = 803 AND PERSONA.ASISTE = 2
    ASSIGN 21
    INCASE PERSONA.DIST = 804 AND PERSONA.ASISTE = 1
    ASSIGN 21
    INCASE PERSONA.DIST = 804 AND PERSONA.ASISTE = 2
    ASSIGN 22
    INCASE PERSONA.DIST = 805 AND PERSONA.ASISTE = 1
    ASSIGN 22
    INCASE PERSONA.DIST = 805 AND PERSONA.ASISTE = 2
    ASSIGN 23
    INCASE PERSONA.DIST = 806 AND PERSONA.ASISTE = 1
    ASSIGN 23
    INCASE PERSONA.DIST = 806 AND PERSONA.ASISTE = 2
    ASSIGN 24
    INCASE PERSONA.NIVINS = 3 AND PERSONA.GRADO = 101
    ASSIGN 12
    INCASE PERSONA.NIVINS >= 5 AND PERSONA.GRADO = 101
    ASSIGN 12
    TYPE INTEGER
    FOR PERSONA.DIST < 99999 
    VARLABEL "ESCOLARIDAD NBI"
    RANGE 0-24
        
/*C0NTANDO JEFES DE HOGAR CON EDUCACIÓN HASTA 2DO GRADO DE ESCUELA. CALCULO CON ESCOLARIDAD SISTEMA VIGENTE SON 3 AÑOS */
 
DEFINE HOGAR.JEFEDU1
    AS SWITCH
    INCASE PERSONA.PARENT = 0 AND PERSONA.ESCONBI > 3
    ASSIGN 0
    INCASE PERSONA.PARENT = 0 AND PERSONA.ESCONBI <= 3
    ASSIGN 1
    INCASE PERSONA.PARENT = 0 AND PERSONA.NIVINS = 0
    ASSIGN 1
    TYPE INTEGER
    RANGE 0-9
    VALUELABELS
    9 "no clasificado"
        MISSING 9
        
        
/*  DEPENDENCIA (HOGARES CON MÁS DE 3 MIEMBROS Y JEFE APROBADO MÁXIMO 2 AÑOS */ 
                         
DEFINE HOGAR.DEPEND1
    AS SWITCH
    INCASE HOGAR.MIXOCU1 = 1 AND HOGAR.JEFEDU1 = 1
    ASSIGN 1
    INCASE HOGAR.MIXOCU1 = 1 AND HOGAR.JEFEDU1 = 0
    ASSIGN 0
    INCASE HOGAR.MIXOCU1 = 1 AND HOGAR.JEFEDU1 = 9
    ASSIGN 9
    INCASE HOGAR.MIXOCU1 = 0 AND HOGAR.JEFEDU1 = 1
    ASSIGN 0
    INCASE HOGAR.MIXOCU1 = 0 AND HOGAR.JEFEDU1 = 0
    ASSIGN 0
    INCASE HOGAR.MIXOCU1 = 0 AND HOGAR.JEFEDU1 = 9
    ASSIGN 9
    TYPE INTEGER
    RANGE 0-9
    VARLABEL "DEPENDENCIA"
    VALUELABELS
    0 " Hogares sin dependencia económica"
    1 "Hogares con dependencia económica" 
    9 "no clasificado"

 /*                   
TABLE DEPEND1
        TITLE "DEPENDENCIA ECONÓMICA"
    AS FREQUENCY 
    OF HOGAR.DEPEND1
        COMPLETENAME
   */
                            
******************************** CALCULANDO NBI**************************************
    
DEFINE HOGAR.NBI1
    AS SWITCH
    INCASE HOGAR.DEPEND1 < 9
    ASSIGN HOGAR.MATERIAL + HOGAR.SERVICIO + HOGAR.defhacin + HOGAR.NINNOASIS + HOGAR.DEPEND1
    INCASE HOGAR.DEPEND1 = 9
    ASSIGN HOGAR.MATERIAL + HOGAR.SERVICIO + HOGAR.defhacin + HOGAR.NINNOASIS
    TYPE INTEGER
    RANGE 0-9
    VALUELABELS
    9 "no clasificado"
    

*DISTRIBUCION NBI* 
  
DEFINE HOGAR.NBIFIN
    AS SWITCH
    INCASE HOGAR.DEPEND1 = 9 AND HOGAR.NBI1 >= 1
    ASSIGN 1
    INCASE HOGAR.NBI1 = 0 AND HOGAR.DEPEND1 < 9
    ASSIGN 0
    INCASE HOGAR.NBI1 = 1 AND HOGAR.DEPEND1 < 9
    ASSIGN 1
    INCASE HOGAR.NBI1 >= 2 AND HOGAR.DEPEND1 < 9
    ASSIGN 1
    TYPE INTEGER
    VARLABEL "HOGARES SEGUN NIVEL DE POBREZA"
    VALUELABELS
    1 "HOGARES POBRES"
    0 "HOGARES NO POBRES"
    RANGE 0-1
    
TABLE TABLE584
    AS FREQUENCY 
    OF HOGAR.NBIFIN
    TALLY HOGAR.TOTPER
     
TABLE PROVIN AS AREALIST OF PROVIN, PROVIN.NOMPROV, HOGAR.NBIFIN
TALLY HOGAR.TOTPER
TOTAL

TABLE CANT AS AREALIST OF CANTON, CANTON.NOMCANT, HOGAR.NBIFIN
TALLY HOGAR.TOTPER
TOTAL

TABLE PARR AS AREALIST OF PARROQ, PARROQ.NOMPARR, HOGAR.NBIFIN
TALLY HOGAR.TOTPER
TOTAL

TABLE ZON AS AREALIST OF ZONA, ZONA.IDZONA, HOGAR.NBIFIN
TALLY HOGAR.TOTPER
TOTAL

TABLE SEC AS AREALIST OF SECTOR, SECTOR.IDSECTOR, HOGAR.NBIFIN
TALLY HOGAR.TOTPER
TOTAL
*/    
